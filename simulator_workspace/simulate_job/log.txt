2024-09-23 17:15:38,446 - SimulatorRunner - INFO - Create the Simulator Server.
2024-09-23 17:15:38,450 - CoreCell - INFO - server: creating listener on tcp://0:54829
2024-09-23 17:15:38,479 - CoreCell - INFO - server: created backbone external listener for tcp://0:54829
2024-09-23 17:15:38,479 - ConnectorManager - INFO - 18047: Try start_listener Listener resources: {'secure': False, 'host': 'localhost'}
2024-09-23 17:15:38,480 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00002 PASSIVE tcp://0:48224] is starting
2024-09-23 17:15:38,981 - CoreCell - INFO - server: created backbone internal listener for tcp://localhost:48224
2024-09-23 17:15:38,982 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00001 PASSIVE tcp://0:54829] is starting
2024-09-23 17:15:39,101 - nvflare.fuel.hci.server.hci - INFO - Starting Admin Server localhost on Port 60195
2024-09-23 17:15:39,101 - SimulatorRunner - INFO - Deploy the Apps.
2024-09-23 17:15:39,103 - SimulatorRunner - INFO - Create the simulate clients.
2024-09-23 17:15:39,108 - ClientManager - INFO - Client: New client site-1@192.168.0.105 joined. Sent token: eb0e37b3-b924-4d94-8470-6fa243d02aa1.  Total clients: 1
2024-09-23 17:15:39,109 - FederatedClient - INFO - Successfully registered client:site-1 for project simulator_server. Token:eb0e37b3-b924-4d94-8470-6fa243d02aa1 SSID:
2024-09-23 17:15:39,110 - ClientManager - INFO - Client: New client site-2@192.168.0.105 joined. Sent token: a07986db-1af1-42c5-844a-e5a10a107d01.  Total clients: 2
2024-09-23 17:15:39,110 - FederatedClient - INFO - Successfully registered client:site-2 for project simulator_server. Token:a07986db-1af1-42c5-844a-e5a10a107d01 SSID:
2024-09-23 17:15:39,110 - SimulatorRunner - INFO - Set the client status ready.
2024-09-23 17:15:39,110 - SimulatorRunner - INFO - Deploy and start the Server App.
2024-09-23 17:15:39,112 - Cell - INFO - Register blob CB for channel='server_command', topic='*'
2024-09-23 17:15:39,112 - Cell - INFO - Register blob CB for channel='aux_communication', topic='*'
2024-09-23 17:15:39,112 - ServerCommandAgent - INFO - ServerCommandAgent cell register_request_cb: server.simulate_job
2024-09-23 17:15:41,741 - numexpr.utils - INFO - Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2024-09-23 17:15:41,741 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2024-09-23 17:15:43,888 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: Server runner starting ...
2024-09-23 17:15:43,890 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: starting workflow gradient_aggregation_workflow (<class 'workflow.gradient_aggregation_workflow.GradientAggregationWorkflow'>) ...
2024-09-23 17:15:43,891 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: Workflow gradient_aggregation_workflow (<class 'workflow.gradient_aggregation_workflow.GradientAggregationWorkflow'>) started
2024-09-23 17:15:43,893 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: scheduled task train_and_get_gradients
2024-09-23 17:15:44,439 - SimulatorClientRunner - INFO - Start the clients run simulation.
2024-09-23 17:15:45,442 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: None
2024-09-23 17:15:45,443 - SimulatorClientRunner - INFO - Simulate Run client: site-2 on GPU group: None
2024-09-23 17:15:46,576 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00005 127.0.0.1:54829 <= 127.0.0.1:37506] is created: PID: 18047
2024-09-23 17:15:46,578 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00006 127.0.0.1:54829 <= 127.0.0.1:37510] is created: PID: 18047
2024-09-23 17:15:54,370 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, task_name=train_and_get_gradients, task_id=c5825a07-ca5d-4a9b-987b-7695b1705c52]: assigned task to client site-2: name=train_and_get_gradients, id=c5825a07-ca5d-4a9b-987b-7695b1705c52
2024-09-23 17:15:54,372 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, task_name=train_and_get_gradients, task_id=c5825a07-ca5d-4a9b-987b-7695b1705c52]: sent task assignment to client. client_name:site-2 task_id:c5825a07-ca5d-4a9b-987b-7695b1705c52
2024-09-23 17:15:54,374 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: train_and_get_gradients   task_id: c5825a07-ca5d-4a9b-987b-7695b1705c52  sharable_header_task_id: c5825a07-ca5d-4a9b-987b-7695b1705c52
2024-09-23 17:15:54,383 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, task_name=train_and_get_gradients, task_id=fdcd44d0-fc62-4f12-81ca-9d66ce0ae759]: assigned task to client site-1: name=train_and_get_gradients, id=fdcd44d0-fc62-4f12-81ca-9d66ce0ae759
2024-09-23 17:15:54,385 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, task_name=train_and_get_gradients, task_id=fdcd44d0-fc62-4f12-81ca-9d66ce0ae759]: sent task assignment to client. client_name:site-1 task_id:fdcd44d0-fc62-4f12-81ca-9d66ce0ae759
2024-09-23 17:15:54,386 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: train_and_get_gradients   task_id: fdcd44d0-fc62-4f12-81ca-9d66ce0ae759  sharable_header_task_id: fdcd44d0-fc62-4f12-81ca-9d66ce0ae759
2024-09-23 17:15:59,940 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job]: got result from client site-1 for task: name=train_and_get_gradients, id=fdcd44d0-fc62-4f12-81ca-9d66ce0ae759
2024-09-23 17:15:59,941 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train_and_get_gradients, task_id=fdcd44d0-fc62-4f12-81ca-9d66ce0ae759]: finished processing client result by gradient_aggregation_workflow
2024-09-23 17:15:59,941 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-1   task_id:fdcd44d0-fc62-4f12-81ca-9d66ce0ae759
2024-09-23 17:16:04,918 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job]: got result from client site-2 for task: name=train_and_get_gradients, id=c5825a07-ca5d-4a9b-987b-7695b1705c52
2024-09-23 17:16:04,919 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, peer_rc=OK, task_name=train_and_get_gradients, task_id=c5825a07-ca5d-4a9b-987b-7695b1705c52]: finished processing client result by gradient_aggregation_workflow
2024-09-23 17:16:04,919 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-2   task_id:c5825a07-ca5d-4a9b-987b-7695b1705c52
2024-09-23 17:16:04,920 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: task train_and_get_gradients exit with status TaskCompletionStatus.OK
2024-09-23 17:16:05,419 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: Start gradient aggregation.
2024-09-23 17:16:05,424 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: End gradient aggregation.
2024-09-23 17:16:05,425 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: scheduled task accept_aggregated_gradients
2024-09-23 17:16:05,470 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, task_name=accept_aggregated_gradients, task_id=a3c80c6f-0e15-4590-beb7-1e8de22dbe02]: assigned task to client site-1: name=accept_aggregated_gradients, id=a3c80c6f-0e15-4590-beb7-1e8de22dbe02
2024-09-23 17:16:05,472 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, task_name=accept_aggregated_gradients, task_id=a3c80c6f-0e15-4590-beb7-1e8de22dbe02]: sent task assignment to client. client_name:site-1 task_id:a3c80c6f-0e15-4590-beb7-1e8de22dbe02
2024-09-23 17:16:05,473 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: accept_aggregated_gradients   task_id: a3c80c6f-0e15-4590-beb7-1e8de22dbe02  sharable_header_task_id: a3c80c6f-0e15-4590-beb7-1e8de22dbe02
2024-09-23 17:16:05,543 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job]: got result from client site-1 for task: name=accept_aggregated_gradients, id=a3c80c6f-0e15-4590-beb7-1e8de22dbe02
2024-09-23 17:16:05,544 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=accept_aggregated_gradients, task_id=a3c80c6f-0e15-4590-beb7-1e8de22dbe02]: finished processing client result by gradient_aggregation_workflow
2024-09-23 17:16:05,544 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-1   task_id:a3c80c6f-0e15-4590-beb7-1e8de22dbe02
2024-09-23 17:16:06,932 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, task_name=accept_aggregated_gradients, task_id=daa973b2-3581-4564-a1f2-a38c987f4a19]: assigned task to client site-2: name=accept_aggregated_gradients, id=daa973b2-3581-4564-a1f2-a38c987f4a19
2024-09-23 17:16:06,934 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, task_name=accept_aggregated_gradients, task_id=daa973b2-3581-4564-a1f2-a38c987f4a19]: sent task assignment to client. client_name:site-2 task_id:daa973b2-3581-4564-a1f2-a38c987f4a19
2024-09-23 17:16:06,935 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: accept_aggregated_gradients   task_id: daa973b2-3581-4564-a1f2-a38c987f4a19  sharable_header_task_id: daa973b2-3581-4564-a1f2-a38c987f4a19
2024-09-23 17:16:06,991 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job]: got result from client site-2 for task: name=accept_aggregated_gradients, id=daa973b2-3581-4564-a1f2-a38c987f4a19
2024-09-23 17:16:06,992 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job, peer_rc=OK, task_name=accept_aggregated_gradients, task_id=daa973b2-3581-4564-a1f2-a38c987f4a19]: finished processing client result by gradient_aggregation_workflow
2024-09-23 17:16:06,992 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-2   task_id:daa973b2-3581-4564-a1f2-a38c987f4a19
2024-09-23 17:16:07,431 - GradientAggregationWorkflow - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: task accept_aggregated_gradients exit with status TaskCompletionStatus.OK
2024-09-23 17:16:07,929 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: Workflow: gradient_aggregation_workflow finalizing ...
2024-09-23 17:16:07,932 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: ABOUT_TO_END_RUN fired
2024-09-23 17:16:07,932 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: Firing CHECK_END_RUN_READINESS ...
2024-09-23 17:16:07,932 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: END_RUN fired
2024-09-23 17:16:07,932 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: Server runner finished.
2024-09-23 17:16:08,058 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-1, peer_run=simulate_job]: server runner is finalizing - asked client to end the run
2024-09-23 17:16:08,061 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: __end_run__   task_id:   sharable_header_task_id: 
2024-09-23 17:16:08,110 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00005 Not Connected] is closed PID: 18047
2024-09-23 17:16:08,998 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow, peer=site-2, peer_run=simulate_job]: server runner is finalizing - asked client to end the run
2024-09-23 17:16:08,998 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: __end_run__   task_id:   sharable_header_task_id: 
2024-09-23 17:16:09,047 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00006 Not Connected] is closed PID: 18047
2024-09-23 17:16:09,050 - FederatedClient - INFO - Shutting down client run: site-1
2024-09-23 17:16:09,059 - FederatedClient - INFO - Shutting down client run: site-2
2024-09-23 17:16:09,060 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=gradient_aggregation_workflow]: asked to abort - triggered abort_signal to stop the RUN
2024-09-23 17:16:10,923 - SimulatorServer - INFO - Server app stopped.


2024-09-23 17:16:11,469 - nvflare.fuel.hci.server.hci - INFO - Admin Server localhost on Port 60195 shutdown!
2024-09-23 17:16:11,469 - SimulatorServer - INFO - shutting down server
2024-09-23 17:16:11,469 - SimulatorServer - INFO - canceling sync locks
2024-09-23 17:16:11,469 - SimulatorServer - INFO - server off
2024-09-23 17:16:14,976 - MPM - INFO - MPM: Good Bye!
